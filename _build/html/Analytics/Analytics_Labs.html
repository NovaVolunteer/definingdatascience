

<!DOCTYPE html>


<html lang="en" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Analytics LABS &#8212; Defining Data Science</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=e353d410970836974a52" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=e353d410970836974a52" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" href="../_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=e353d410970836974a52" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52" />

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'Analytics/Analytics_Labs';</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Analytics CASE Study" href="Analytics_Case.html" />
    <link rel="prev" title="Instructional Materials" href="Instructional-Intro.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
  

<a class="navbar-brand logo" href="../intro.html">
  
  
  
  
    
    
      
    
    
    <img src="../_static/image5.png" class="logo__image only-light" alt="Logo image"/>
    <script>document.write(`<img src="../_static/image5.png" class="logo__image only-dark" alt="Logo image"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../intro.html">
                    Introduction
                </a>
            </li>
        </ul>
        <ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../foreword.html">Foreword</a></li>
<li class="toctree-l1"><a class="reference internal" href="../how-to.html">How to use this book</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Defining-DS-4%2B1.html">The 4 + 1 Model of Data Science</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Design</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../Design/Design_SDS.html">Design SDS</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../Design/Lectures.html">Design Lectures</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-1"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../Design/Design_Internal.html">Internal Design Lectures</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Design/Design_External.html">External Design Lectures</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../Design/Instructional-Intro.html">Instructional Materials</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-2"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../Design/Design_Labs.html">Design LABS</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Design/Design_Case.html">Design CASE</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Design/Design_Look.html">Design LOOK</a></li>
</ul>
</li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Value</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../Value/Value_SDS.html">Value SDS</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../Value/Lectures.html">Value Lectures</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-3"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../Value/Value_Internal.html">Internal Value Lectures</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Value/Value_External.html">External Value Lectures</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../Value/Instructional-Intro.html">Instructional Materials</a><input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-4"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../Value/Value_Labs.html">Value LABS</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Value/Value_Case.html">Value CASE</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Value/Value_Look.html">Value LOOK</a></li>
</ul>
</li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Systems</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../Systems/Systems_SDS.html">Systems SDS</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../Systems/Lectures.html">Systems Lectures</a><input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-5"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../Systems/Systems_Internal.html">Internal Systems Lectures</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Systems/Systems_External.html">External Systems Lectures</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../Systems/Instructional-Intro.html">Instructional Materials</a><input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-6"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../Systems/Systems_Labs.html">Systems LABS</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Systems/Systems_Case.html">Systems CASE</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Systems/Systems_Look.html">Systems LOOK</a></li>
</ul>
</li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Analytics</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="Analytics_SDS.html">Analytics SDS</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="Lectures.html">Analytics Lectures</a><input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-7"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="Analytics_Internal.html">Internal Analytics Lectures</a></li>
<li class="toctree-l2"><a class="reference internal" href="Analytics_External.html">External Analytics Lectures</a></li>
</ul>
</li>
<li class="toctree-l1 current active has-children"><a class="reference internal" href="Instructional-Intro.html">Instructional Materials</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-8"><i class="fa-solid fa-chevron-down"></i></label><ul class="current">
<li class="toctree-l2 current active"><a class="current reference internal" href="#">Analytics LABS</a></li>
<li class="toctree-l2"><a class="reference internal" href="Analytics_Case.html">Analytics CASE Study</a></li>
<li class="toctree-l2"><a class="reference internal" href="Analytics_Look.html">Analytics LOOK</a></li>
</ul>
</li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Final Thoughts</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../final-thoughts.html">Final Thoughts</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Appendix</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../Appendix/appendix-sources.html">Primary Sources</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/NovaVolunteer/definingdatascience" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/NovaVolunteer/definingdatascience/issues/new?title=Issue%20on%20page%20%2FAnalytics/Analytics_Labs.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/Analytics/Analytics_Labs.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>


<script>
document.write(`
  <button class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></span>
    <span class="theme-switch" data-mode="dark"><i class="fa-solid fa-moon"></i></span>
    <span class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></span>
  </button>
`);
</script>

<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Analytics LABS</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#lab-1-mastermind-entropy">Lab 1 - Mastermind entropy</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#lab-2-garbage-in-garbage-out">Lab 2 - Garbage In Garbage Out</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#let-s-take-a-quick-look-at-a-scatter-plot-to-get-an-idea-of-the-distribution-of-the-data">Let’s take a quick look at a scatter plot to get an idea of the distribution of the data.</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#next-lets-build-a-linear-regression-model-to-predict-eruption-length-based-on-waiting-time">Next lets build a linear regression model to predict Eruption Length based on Waiting Time</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#now-we-are-creating-noise-that-aligns-to-a-normal-or-gaussian-distribution-thus-gaussian-noise-to-add-to-the-data">Now we are creating “noise” that aligns to a normal or gaussian distribution, thus gaussian noise, to add to the data.</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#really-a-small-change-let-s-see-what-happens-to-model-quality">Really a small change, let’s see what happens to model quality</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#now-let-s-take-a-look-at-that-same-scatter-plot-but-with-the-new-data">Now let’s take a look at that same scatter plot but with the new data</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#task-1-slowly-change-the-standard-deviation-increments-of-25-stopping-at-3-5-add-the-noise-array-to-the-dataset-with-each-increase-re-run-the-model-and-see-what-happens-with-the-r2-number-note-the-pace-of-change-of-the-model-write-it-down">Task 1: Slowly change the standard deviation (increments of .25, stopping at 3.5), add the noise array to the dataset with each increase, re-run the model and see what happens with the R2 number, note the pace of change of the model (write it down).</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#task-2-following-the-same-process-above-but-instead-adjust-the-mean-to-three-different-increasing-increments-but-leave-the-standard-dev-at-05-note-how-this-changes-the-model-fit">Task 2: Following the same process above but instead adjust the mean to three different increasing increments but leave the standard dev at .05, note how this changes the model fit.</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#questions-for-submission">Questions for submission:</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#lab-3-knn">Lab 3 - kNN</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#overview">Overview</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#dataset">Dataset</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#part-1-data-preparation-and-model-building">Part 1: Data Preparation and Model Building</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#load-the-libraries">Load the Libraries</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#load-the-dataset">Load the Dataset</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#scale-normalizing-variable-classes-lots-more-but-these-are-the-focus-of-this-lab">Scale/Normalizing/Variable Classes (lots more but these are the focus of this lab)</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#example-of-how-to-collapse-categories">Example of how to collapse categories</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#normalizing-the-numeric-values">Normalizing the numeric values</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#one-hot-encoding-the-categorical-values">One-Hot Encoding the categorical values</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#creating-a-binary-target-variable-so-we-can-run-this-model-as-a-classification-problem">Creating a binary target variable so we can run this model as a classification problem.</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#dropping-variables-and-partitioning-train-test">Dropping Variables and Partitioning (Train/Test)</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#model-building-cell">Model Building Cell</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#evaluation-cell">Evaluation Cell</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#task-1">Task 1</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#part-2-probabilities-of-the-model">Part 2: Probabilities of the Model</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#now-we-are-going-to-add-the-percentage-of-the-probability-for-the-positive-class-good-cereal-to-the-dataframe">Now we are going to add the percentage of the probability for the positive class (good cereal) to the dataframe.</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#graph-the-probabilities">Graph the probabilities</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#task-2-determine-how-the-probabilities-are-calculated">Task 2: Determine how the probabilities are calculated</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#second-model-building-cell">Second Model Building Cell</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#graph-cell">Graph Cell</a></li>
</ul>
</li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="analytics-labs">
<h1>Analytics LABS<a class="headerlink" href="#analytics-labs" title="Permalink to this heading">#</a></h1>
<section id="lab-1-mastermind-entropy">
<h2>Lab 1 - Mastermind entropy<a class="headerlink" href="#lab-1-mastermind-entropy" title="Permalink to this heading">#</a></h2>
<p>DS 1001 - Spring 2023 - Professors Wright and Alonzi</p>
<p>Due: End of lab period (or later that day)</p>
<p>Submission format: Word doc or PDF summarizing your findings</p>
<p>Individual Assignment</p>
<p><strong>General Descripition:</strong> This lab is designed to introduce the basic concepts behind information gain and entropy. Mastermind is a game were through a series of questions one player tries to determine a “code” created by another player. In doing so the value of asking questions that provide a high level of information will become paramount.</p>
<p>Preparatory Assignments - None</p>
<p><strong>Why am I doing this?</strong> In order to gain a better understanding of information gain and entropy through hands on experience.</p>
<p><strong>What am I going to do?</strong> Work with a partner or group of three and alternate playing the game. At the onset of each game the code-maker should calculate the entropy of the chosen pegs for the “code”. The code-breaker should note the results of the game . This should include whether the code was broken or not and the number of rounds used. Try to be the code-maker and breaker at least 3 times. The code-maker should intentionally use very different types of “code”, this should impact how the game is played.</p>
<ul class="simple">
<li><p>Note the range of entropy for binary cases is 0 to 1 for more than 2 classes it is 0 to log~2~ <em>k</em>, where <em>k</em> is the number of classes.</p></li>
</ul>
<p><strong>Answer these questions:</strong></p>
<ol class="arabic simple">
<li><p>What combinations of pegs (code) seemed to be harder to break?</p></li>
<li><p>Did your approach to asking questions change as you played?</p></li>
<li><p>Describe where in the game information gain is being presented?</p></li>
</ol>
<p>Tips for success:</p>
<ul class="simple">
<li><p>Don’t worry about winning, instead think about what is happening during game play.</p></li>
<li><p>Work as a team with your group.</p></li>
<li><p>Try to document the process used right at the start of the lab, don’t wait till after you have played to start taking notes.</p></li>
</ul>
<p>How will I know I have succeeded:</p>
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="head"><p>Specs Category</p></th>
<th class="head"><p>Specs Details</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Formatting</p></td>
<td><p>- Submit via Canvas a PDF or Word document</p></td>
</tr>
<tr class="row-odd"><td><p>Text</p></td>
<td><p>- Answer the above questions <br/> - When you were the code-maker submit the Entropy <br/> - When you were the code breaker submit the results</p></td>
</tr>
</tbody>
</table>
<p>Acknowledgements: Special thanks for Jess Taggart from UVA CTE for coaching us. This structure is pulled directory from Steifer &amp; Palmer (2020).</p>
</section>
<section id="lab-2-garbage-in-garbage-out">
<h2>Lab 2 - Garbage In Garbage Out<a class="headerlink" href="#lab-2-garbage-in-garbage-out" title="Permalink to this heading">#</a></h2>
<p><a class="reference external" href="https://colab.research.google.com/github/UVADS/DS1001/blob/master/ddsbook/analytics-lab-IIa.ipynb"><img alt="Open In Colab" src="https://colab.research.google.com/assets/colab-badge.svg" /></a></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># pip install statsmodels</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span> 
<span class="kn">import</span> <span class="nn">statsmodels.api</span> <span class="k">as</span> <span class="nn">sm</span>
</pre></div>
</div>
</div>
</div>
<p><strong>What we are going to do is create a linear model using old faithful data. Then we are going to add Gaussian noise iteratively to a dataset and pass the new noisy dataset to a the same linear regression model and track the ability of the model to learn the target as noise increases.</strong></p>
<ol class="arabic simple">
<li><p>Read this brief wiki on garbage in garbage out: <a class="reference external" href="https://en.wikipedia.org/wiki/Garbage_in,_garbage_out">article</a></p></li>
<li><p>Work through the below notebook, paying close attention to the comments and the outputs of the code.</p></li>
<li><p>Answer the questions at the end as they relate to the process of adding noise to a dataset and then passing it to a linear regression model.</p></li>
</ol>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># The dataset we will be using is a well known measure of eruption and wait times for old faithful. </span>
<span class="c1"># Take a look at the documentation </span>
<span class="c1"># here: https://www.rdocumentation.org/packages/datasets/versions/3.6.2/topics/faithful</span>


<span class="c1"># This is our data source (.tsv == tab separated), here we are creating a variable that holds the url to the data.</span>
<span class="c1"># If you click the {x} in the ribbon to the left you will see the variables you have created.</span>
<span class="n">url</span><span class="o">=</span><span class="s2">&quot;https://gist.githubusercontent.com/curran/4b59d1046d9e66f2787780ad51a1cd87/raw/9ec906b78a98cf300947a37b56cfe70d01183200/data.tsv&quot;</span>


<span class="c1"># Here we are reading in the data, and use the &quot;tab&quot; as a separator so the data will be loaded </span>
<span class="c1"># in correctly.  pd stands for pandas and &quot;pd.read_csv&quot; is the function we are </span>
<span class="c1"># using to read in the data from the url.</span>
<span class="n">old_faith</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<section id="let-s-take-a-quick-look-at-a-scatter-plot-to-get-an-idea-of-the-distribution-of-the-data">
<h3>Let’s take a quick look at a scatter plot to get an idea of the distribution of the data.<a class="headerlink" href="#let-s-take-a-quick-look-at-a-scatter-plot-to-get-an-idea-of-the-distribution-of-the-data" title="Permalink to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#plt (matplotlib.pyplot) is the library we are using to create our scatter plot.  We are using the &quot;scatter&quot; function, </span>
<span class="c1"># and the alpha is the transparency of the dots.</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">old_faith</span><span class="o">.</span><span class="n">waiting</span><span class="p">,</span><span class="n">old_faith</span><span class="o">.</span><span class="n">eruptions</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="c1"># here we are adding the labels to the x and y axis</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Eruption Seconds&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Waiting Minutes&quot;</span><span class="p">)</span>

<span class="c1">#this is the function that renders the plot</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1"># Note the patterns that you see, (you&#39;ll need this for your submission) </span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/2f2cbe6833754ede9f22dc785ccf59a29daee4db167f77b780917fbf4a0ddeab.png" src="../_images/2f2cbe6833754ede9f22dc785ccf59a29daee4db167f77b780917fbf4a0ddeab.png" />
</div>
</div>
</section>
<section id="next-lets-build-a-linear-regression-model-to-predict-eruption-length-based-on-waiting-time">
<h3>Next lets build a linear regression model to predict Eruption Length based on Waiting Time<a class="headerlink" href="#next-lets-build-a-linear-regression-model-to-predict-eruption-length-based-on-waiting-time" title="Permalink to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Here we are using the statsmodels library to create a linear regression model. sm stands for statsmodels and OLS </span>
<span class="c1"># stands for Ordinary Least Squares.  We are using the &quot;fit&quot; function to fit the model to the data.</span>
<span class="n">lm</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">OLS</span><span class="p">(</span><span class="n">old_faith</span><span class="p">[</span><span class="s1">&#39;waiting&#39;</span><span class="p">],</span><span class="n">old_faith</span><span class="p">[</span><span class="s1">&#39;eruptions&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>

<span class="c1"># Now we are printing out the summary of the model (lm). The summary function will give you the R2 measure, along with </span>
<span class="c1"># other measures of model fit. </span>
<span class="n">lm</span><span class="o">.</span><span class="n">summary</span><span class="p">()</span>

<span class="c1">#Using the R2 measure, how well does the model predict eruption length (scale of 0 to 1,</span>
<span class="c1">#  where 1 is perfect, again needed for your submission)?</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><table class="simpletable">
<caption>OLS Regression Results</caption>
<tr>
  <th>Dep. Variable:</th>         <td>waiting</td>     <th>  R-squared (uncentered):</th>      <td>   0.973</td> 
</tr>
<tr>
  <th>Model:</th>                   <td>OLS</td>       <th>  Adj. R-squared (uncentered):</th> <td>   0.973</td> 
</tr>
<tr>
  <th>Method:</th>             <td>Least Squares</td>  <th>  F-statistic:       </th>          <td>   9621.</td> 
</tr>
<tr>
  <th>Date:</th>             <td>Mon, 23 Oct 2023</td> <th>  Prob (F-statistic):</th>          <td>9.97e-214</td>
</tr>
<tr>
  <th>Time:</th>                 <td>15:18:30</td>     <th>  Log-Likelihood:    </th>          <td> -1060.7</td> 
</tr>
<tr>
  <th>No. Observations:</th>      <td>   272</td>      <th>  AIC:               </th>          <td>   2123.</td> 
</tr>
<tr>
  <th>Df Residuals:</th>          <td>   271</td>      <th>  BIC:               </th>          <td>   2127.</td> 
</tr>
<tr>
  <th>Df Model:</th>              <td>     1</td>      <th>                     </th>              <td> </td>    
</tr>
<tr>
  <th>Covariance Type:</th>      <td>nonrobust</td>    <th>                     </th>              <td> </td>    
</tr>
</table>
<table class="simpletable">
<tr>
      <td></td>         <th>coef</th>     <th>std err</th>      <th>t</th>      <th>P>|t|</th>  <th>[0.025</th>    <th>0.975]</th>  
</tr>
<tr>
  <th>eruptions</th> <td>   19.4019</td> <td>    0.198</td> <td>   98.086</td> <td> 0.000</td> <td>   19.013</td> <td>   19.791</td>
</tr>
</table>
<table class="simpletable">
<tr>
  <th>Omnibus:</th>       <td>31.065</td> <th>  Durbin-Watson:     </th> <td>   2.646</td>
</tr>
<tr>
  <th>Prob(Omnibus):</th> <td> 0.000</td> <th>  Jarque-Bera (JB):  </th> <td>  10.019</td>
</tr>
<tr>
  <th>Skew:</th>          <td> 0.148</td> <th>  Prob(JB):          </th> <td> 0.00667</td>
</tr>
<tr>
  <th>Kurtosis:</th>      <td> 2.108</td> <th>  Cond. No.          </th> <td>    1.00</td>
</tr>
</table><br/><br/>Notes:<br/>[1] R² is computed without centering (uncentered) since the model does not contain a constant.<br/>[2] Standard Errors assume that the covariance matrix of the errors is correctly specified.</div></div>
</div>
</section>
<section id="now-we-are-creating-noise-that-aligns-to-a-normal-or-gaussian-distribution-thus-gaussian-noise-to-add-to-the-data">
<h3>Now we are creating “noise” that aligns to a normal or gaussian distribution, thus gaussian noise, to add to the data.<a class="headerlink" href="#now-we-are-creating-noise-that-aligns-to-a-normal-or-gaussian-distribution-thus-gaussian-noise-to-add-to-the-data" title="Permalink to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># mu= mean and sigma = standard deviation, these are the inputs you will be changing</span>
<span class="n">mu</span><span class="p">,</span> <span class="n">sigma</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">.5</span> 
<span class="c1"># We need to create noise with the same dimensions as the dataset (272,2), this will allow us </span>
<span class="c1"># to combine them easily</span>
<span class="n">noise</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">mu</span><span class="p">,</span> <span class="n">sigma</span><span class="p">,</span> <span class="p">[</span><span class="mi">272</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span>
<span class="c1"># The print function will print the first 5 rows of the noise array </span>
<span class="nb">print</span><span class="p">(</span><span class="n">noise</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">5</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[[-0.4850332   0.11126269]
 [-0.22372406 -0.0602728 ]
 [ 0.52256881 -0.56696117]
 [-0.42812706  0.23496939]
 [-0.2218687   0.33879406]]
</pre></div>
</div>
</div>
</div>
</section>
<section id="really-a-small-change-let-s-see-what-happens-to-model-quality">
<h3>Really a small change, let’s see what happens to model quality<a class="headerlink" href="#really-a-small-change-let-s-see-what-happens-to-model-quality" title="Permalink to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Here we are adding the noise to the dataset</span>
<span class="n">old_faith_1</span><span class="o">=</span><span class="n">old_faith</span> <span class="o">+</span> <span class="n">noise</span>

<span class="c1">#Create a new model with the noise added to the data</span>
<span class="n">lm_1</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">OLS</span><span class="p">(</span><span class="n">old_faith_1</span><span class="p">[</span><span class="s1">&#39;waiting&#39;</span><span class="p">],</span><span class="n">old_faith_1</span><span class="p">[</span><span class="s1">&#39;eruptions&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>

<span class="c1">#Checking the R2 number, note what happens.</span>
<span class="n">lm_1</span><span class="o">.</span><span class="n">summary</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><table class="simpletable">
<caption>OLS Regression Results</caption>
<tr>
  <th>Dep. Variable:</th>         <td>waiting</td>     <th>  R-squared (uncentered):</th>      <td>   0.951</td> 
</tr>
<tr>
  <th>Model:</th>                   <td>OLS</td>       <th>  Adj. R-squared (uncentered):</th> <td>   0.951</td> 
</tr>
<tr>
  <th>Method:</th>             <td>Least Squares</td>  <th>  F-statistic:       </th>          <td>   5229.</td> 
</tr>
<tr>
  <th>Date:</th>             <td>Mon, 23 Oct 2023</td> <th>  Prob (F-statistic):</th>          <td>3.50e-179</td>
</tr>
<tr>
  <th>Time:</th>                 <td>15:18:30</td>     <th>  Log-Likelihood:    </th>          <td> -1140.4</td> 
</tr>
<tr>
  <th>No. Observations:</th>      <td>   272</td>      <th>  AIC:               </th>          <td>   2283.</td> 
</tr>
<tr>
  <th>Df Residuals:</th>          <td>   271</td>      <th>  BIC:               </th>          <td>   2286.</td> 
</tr>
<tr>
  <th>Df Model:</th>              <td>     1</td>      <th>                     </th>              <td> </td>    
</tr>
<tr>
  <th>Covariance Type:</th>      <td>nonrobust</td>    <th>                     </th>              <td> </td>    
</tr>
</table>
<table class="simpletable">
<tr>
      <td></td>         <th>coef</th>     <th>std err</th>      <th>t</th>      <th>P>|t|</th>  <th>[0.025</th>    <th>0.975]</th>  
</tr>
<tr>
  <th>eruptions</th> <td>   19.4567</td> <td>    0.269</td> <td>   72.312</td> <td> 0.000</td> <td>   18.927</td> <td>   19.986</td>
</tr>
</table>
<table class="simpletable">
<tr>
  <th>Omnibus:</th>       <td> 6.696</td> <th>  Durbin-Watson:     </th> <td>   2.330</td>
</tr>
<tr>
  <th>Prob(Omnibus):</th> <td> 0.035</td> <th>  Jarque-Bera (JB):  </th> <td>   3.797</td>
</tr>
<tr>
  <th>Skew:</th>          <td>-0.024</td> <th>  Prob(JB):          </th> <td>   0.150</td>
</tr>
<tr>
  <th>Kurtosis:</th>      <td> 2.423</td> <th>  Cond. No.          </th> <td>    1.00</td>
</tr>
</table><br/><br/>Notes:<br/>[1] R² is computed without centering (uncentered) since the model does not contain a constant.<br/>[2] Standard Errors assume that the covariance matrix of the errors is correctly specified.</div></div>
</div>
</section>
<section id="now-let-s-take-a-look-at-that-same-scatter-plot-but-with-the-new-data">
<h3>Now let’s take a look at that same scatter plot but with the new data<a class="headerlink" href="#now-let-s-take-a-look-at-that-same-scatter-plot-but-with-the-new-data" title="Permalink to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">old_faith_1</span><span class="o">.</span><span class="n">waiting</span><span class="p">,</span><span class="n">old_faith_1</span><span class="o">.</span><span class="n">eruptions</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Eruption Seconds&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Waiting Minutes&quot;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/d01a05e025f40b22a844f3ae2923fc4fa0b11ed58a3c28d4741176d3e66a8b02.png" src="../_images/d01a05e025f40b22a844f3ae2923fc4fa0b11ed58a3c28d4741176d3e66a8b02.png" />
</div>
</div>
</section>
<section id="task-1-slowly-change-the-standard-deviation-increments-of-25-stopping-at-3-5-add-the-noise-array-to-the-dataset-with-each-increase-re-run-the-model-and-see-what-happens-with-the-r2-number-note-the-pace-of-change-of-the-model-write-it-down">
<h3>Task 1: Slowly change the standard deviation (increments of .25, stopping at 3.5), add the noise array to the dataset with each increase, re-run the model and see what happens with the R2 number, note the pace of change of the model (write it down).<a class="headerlink" href="#task-1-slowly-change-the-standard-deviation-increments-of-25-stopping-at-3-5-add-the-noise-array-to-the-dataset-with-each-increase-re-run-the-model-and-see-what-happens-with-the-r2-number-note-the-pace-of-change-of-the-model-write-it-down" title="Permalink to this heading">#</a></h3>
</section>
<section id="task-2-following-the-same-process-above-but-instead-adjust-the-mean-to-three-different-increasing-increments-but-leave-the-standard-dev-at-05-note-how-this-changes-the-model-fit">
<h3>Task 2: Following the same process above but instead adjust the mean to three different increasing increments but leave the standard dev at .05, note how this changes the model fit.<a class="headerlink" href="#task-2-following-the-same-process-above-but-instead-adjust-the-mean-to-three-different-increasing-increments-but-leave-the-standard-dev-at-05-note-how-this-changes-the-model-fit" title="Permalink to this heading">#</a></h3>
</section>
<section id="questions-for-submission">
<h3>Questions for submission:<a class="headerlink" href="#questions-for-submission" title="Permalink to this heading">#</a></h3>
<ol class="arabic simple">
<li><p>What patterns do you see in the original data (from the scatter plot)?</p></li>
<li><p>How well did the first model fit the original data (from the model output)?</p></li>
<li><p>What happens when you add the standard deviation oriented noise to the data, at what level does the model appear to degrade significantly?</p></li>
<li><p>What happens when you add the mean noise to the data while holding the standard dev constant, does the model degrade at the same level as the standard deviation noise? Why or why not?</p></li>
<li><p>Explain the concept behind noise versus signal as it relates to the old faithful dataset, how does this relate to garbage in garbage out?</p></li>
<li><p>Explain what the linear regression model is doing.</p></li>
</ol>
</section>
</section>
<section id="lab-3-knn">
<h2>Lab 3 - kNN<a class="headerlink" href="#lab-3-knn" title="Permalink to this heading">#</a></h2>
<p><a class="reference external" href="https://colab.research.google.com/github/UVADS/DS1001/blob/master/ddsbook/analytics-lab-III.ipynb"><img alt="Open In Colab" src="https://colab.research.google.com/assets/colab-badge.svg" /></a></p>
<section id="overview">
<h3>Overview<a class="headerlink" href="#overview" title="Permalink to this heading">#</a></h3>
<p><strong>The goal of this lab is provide you with a better understand of how machine learning models work. The model you will be building is a supervised classification model, k nearest neighbor (kNN). This notebook will walk you through a shorten series of steps necessary to prepare the data, build the model, evaluated the output and visualize the predictions. You’ll need to run all the cells to make the model work correctly. Do so one at a time, in order, by pressing the play button in the top left corner of each cell.</strong></p>
<p><strong>You will then be asked to interpret and manipulate the model features with the goal of better understanding how kNN generates it’s predictions. The lab will focus on the concepts of over/under fitting and how kNN generates probability estimates.</strong></p>
</section>
<section id="dataset">
<h3>Dataset<a class="headerlink" href="#dataset" title="Permalink to this heading">#</a></h3>
<p><strong>The data we will be using is the cereal dataset from the UCI Machine Learning Repository. The dataset contains 77 observations of 16 variables. The goal of this lab is to build a kNN model that can predict the target variable based on the 15 predictor variables.</strong></p>
</section>
<section id="part-1-data-preparation-and-model-building">
<h3>Part 1: Data Preparation and Model Building<a class="headerlink" href="#part-1-data-preparation-and-model-building" title="Permalink to this heading">#</a></h3>
<section id="load-the-libraries">
<h4>Load the Libraries<a class="headerlink" href="#load-the-libraries" title="Permalink to this heading">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#First we import the libraries we need</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span> 
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span> 
<span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">MinMaxScaler</span><span class="p">,</span> <span class="n">StandardScaler</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span>
<span class="kn">from</span> <span class="nn">sklearn.neighbors</span> <span class="kn">import</span> <span class="n">KNeighborsClassifier</span>
<span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">pyplot</span> <span class="k">as</span> <span class="n">plt</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="load-the-dataset">
<h4>Load the Dataset<a class="headerlink" href="#load-the-dataset" title="Permalink to this heading">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#read in the cereal dataset, we are reading the data in from a URL associated with the Foundations of </span>
<span class="c1">#machine learning class</span>

<span class="n">cereal</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;https://raw.githubusercontent.com/UVADS/DS-3001/main/data/cereal.csv&quot;</span><span class="p">)</span>

<span class="n">cereal</span><span class="o">.</span><span class="n">info</span><span class="p">()</span> <span class="c1"># Let&#39;s check the structure of the dataset and see if we have any issues with variable classes</span>
<span class="c1">#usually it&#39;s converting things to category</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
RangeIndex: 77 entries, 0 to 76
Data columns (total 16 columns):
 #   Column    Non-Null Count  Dtype  
---  ------    --------------  -----  
 0   name      77 non-null     object 
 1   mfr       77 non-null     object 
 2   type      77 non-null     object 
 3   calories  77 non-null     int64  
 4   protein   77 non-null     int64  
 5   fat       77 non-null     int64  
 6   sodium    77 non-null     int64  
 7   fiber     77 non-null     float64
 8   carbo     77 non-null     float64
 9   sugars    77 non-null     int64  
 10  potass    77 non-null     int64  
 11  vitamins  77 non-null     int64  
 12  shelf     77 non-null     int64  
 13  weight    77 non-null     float64
 14  cups      77 non-null     float64
 15  rating    77 non-null     float64
dtypes: float64(5), int64(8), object(3)
memory usage: 9.8+ KB
</pre></div>
</div>
</div>
</div>
</section>
<section id="scale-normalizing-variable-classes-lots-more-but-these-are-the-focus-of-this-lab">
<h4>Scale/Normalizing/Variable Classes (lots more but these are the focus of this lab)<a class="headerlink" href="#scale-normalizing-variable-classes-lots-more-but-these-are-the-focus-of-this-lab" title="Permalink to this heading">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Looks like columns 1,2,11 and 12 need to be converted to category</span>

<span class="n">Column_index_list</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">11</span><span class="p">,</span><span class="mi">12</span><span class="p">]</span>
<span class="n">cereal</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span><span class="n">Column_index_list</span><span class="p">]</span><span class="o">=</span> <span class="n">cereal</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span><span class="n">Column_index_list</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;category&#39;</span><span class="p">)</span> 
<span class="n">cereal</span><span class="o">.</span><span class="n">type</span> <span class="o">=</span> <span class="n">cereal</span><span class="o">.</span><span class="n">type</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;category&#39;</span><span class="p">)</span>
<span class="c1">#iloc accesses the index of a dataframe, bypassing having to manually type in the names of each column</span>

<span class="n">cereal</span><span class="o">.</span><span class="n">dtypes</span> <span class="c1">#another way of checking the structure of the dataset. Simpler, but does not give an index</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>name          object
mfr           object
type        category
calories       int64
protein        int64
fat            int64
sodium         int64
fiber        float64
carbo        float64
sugars         int64
potass         int64
vitamins    category
shelf       category
weight       float64
cups         float64
rating       float64
dtype: object
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Let&#39;s take a closer look at mfr</span>
<span class="n">cereal</span><span class="o">.</span><span class="n">mfr</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span> <span class="c1">#value_counts() simply displays variable counts as a vertical table.</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>mfr
K    23
G    22
P     9
Q     8
R     8
N     6
A     1
Name: count, dtype: int64
</pre></div>
</div>
</div>
</div>
</section>
<section id="example-of-how-to-collapse-categories">
<h4>Example of how to collapse categories<a class="headerlink" href="#example-of-how-to-collapse-categories" title="Permalink to this heading">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Usually don&#39;t want more than 5ish groups, so we should collapse this factor  </span>
<span class="c1">#Keep the large groups (G, K) and group all the smaller categories as &quot;Other&quot;</span>

<span class="n">top</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;K&#39;</span><span class="p">,</span><span class="s1">&#39;G&#39;</span><span class="p">]</span>
<span class="n">cereal</span><span class="o">.</span><span class="n">mfr</span> <span class="o">=</span> <span class="p">(</span><span class="n">cereal</span><span class="o">.</span><span class="n">mfr</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span> <span class="k">if</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">top</span> <span class="k">else</span> <span class="s2">&quot;Other&quot;</span><span class="p">))</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;category&#39;</span><span class="p">)</span>
<span class="c1">#lambda is a small anonymous function that can take any number of arguments but can only have one expression</span>
<span class="c1">#a example lambda function is lambda a: a+10, if we passed 5 to this we would get back 15</span>
<span class="c1">#lambda functions are best used inside of another function, like in this example when it is used inside the apply function</span>
<span class="c1">#to use an if function in a lambda statement, the True return value comes first (x), then the if statement, then else, and then the False return</span>

<span class="n">cereal</span><span class="o">.</span><span class="n">mfr</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span> <span class="c1">#This is a lot better</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>mfr
Other    32
K        23
G        22
Name: count, dtype: int64
</pre></div>
</div>
</div>
</div>
</section>
<section id="normalizing-the-numeric-values">
<h4>Normalizing the numeric values<a class="headerlink" href="#normalizing-the-numeric-values" title="Permalink to this heading">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Here we are normalizing the numeric values and creating a index based on numeric columns:</span>
<span class="n">abc</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">cereal</span><span class="o">.</span><span class="n">select_dtypes</span><span class="p">(</span><span class="s1">&#39;number&#39;</span><span class="p">))</span> <span class="c1">#select function to find the numeric variables and create a list  </span>

<span class="n">cereal</span><span class="p">[</span><span class="n">abc</span><span class="p">]</span> <span class="o">=</span> <span class="n">MinMaxScaler</span><span class="p">()</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">cereal</span><span class="p">[</span><span class="n">abc</span><span class="p">])</span>
<span class="n">cereal</span> <span class="c1">#notice the difference in the range of values for the numeric variables</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>name</th>
      <th>mfr</th>
      <th>type</th>
      <th>calories</th>
      <th>protein</th>
      <th>fat</th>
      <th>sodium</th>
      <th>fiber</th>
      <th>carbo</th>
      <th>sugars</th>
      <th>potass</th>
      <th>vitamins</th>
      <th>shelf</th>
      <th>weight</th>
      <th>cups</th>
      <th>rating</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>100% Bran</td>
      <td>Other</td>
      <td>C</td>
      <td>0.181818</td>
      <td>0.6</td>
      <td>0.2</td>
      <td>0.406250</td>
      <td>0.714286</td>
      <td>0.250000</td>
      <td>0.4375</td>
      <td>0.848943</td>
      <td>25</td>
      <td>3</td>
      <td>0.5</td>
      <td>0.064</td>
      <td>0.665593</td>
    </tr>
    <tr>
      <th>1</th>
      <td>100% Natural Bran</td>
      <td>Other</td>
      <td>C</td>
      <td>0.636364</td>
      <td>0.4</td>
      <td>1.0</td>
      <td>0.046875</td>
      <td>0.142857</td>
      <td>0.375000</td>
      <td>0.5625</td>
      <td>0.410876</td>
      <td>0</td>
      <td>3</td>
      <td>0.5</td>
      <td>0.600</td>
      <td>0.210685</td>
    </tr>
    <tr>
      <th>2</th>
      <td>All-Bran</td>
      <td>K</td>
      <td>C</td>
      <td>0.181818</td>
      <td>0.6</td>
      <td>0.2</td>
      <td>0.812500</td>
      <td>0.642857</td>
      <td>0.333333</td>
      <td>0.3750</td>
      <td>0.969789</td>
      <td>25</td>
      <td>3</td>
      <td>0.5</td>
      <td>0.064</td>
      <td>0.546941</td>
    </tr>
    <tr>
      <th>3</th>
      <td>All-Bran with Extra Fiber</td>
      <td>K</td>
      <td>C</td>
      <td>0.000000</td>
      <td>0.6</td>
      <td>0.0</td>
      <td>0.437500</td>
      <td>1.000000</td>
      <td>0.375000</td>
      <td>0.0625</td>
      <td>1.000000</td>
      <td>25</td>
      <td>3</td>
      <td>0.5</td>
      <td>0.200</td>
      <td>1.000000</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Almond Delight</td>
      <td>Other</td>
      <td>C</td>
      <td>0.545455</td>
      <td>0.2</td>
      <td>0.4</td>
      <td>0.625000</td>
      <td>0.071429</td>
      <td>0.625000</td>
      <td>0.5625</td>
      <td>0.000000</td>
      <td>25</td>
      <td>3</td>
      <td>0.5</td>
      <td>0.400</td>
      <td>0.215987</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>72</th>
      <td>Triples</td>
      <td>G</td>
      <td>C</td>
      <td>0.545455</td>
      <td>0.2</td>
      <td>0.2</td>
      <td>0.781250</td>
      <td>0.000000</td>
      <td>0.916667</td>
      <td>0.2500</td>
      <td>0.184290</td>
      <td>25</td>
      <td>3</td>
      <td>0.5</td>
      <td>0.400</td>
      <td>0.278387</td>
    </tr>
    <tr>
      <th>73</th>
      <td>Trix</td>
      <td>G</td>
      <td>C</td>
      <td>0.545455</td>
      <td>0.0</td>
      <td>0.2</td>
      <td>0.437500</td>
      <td>0.000000</td>
      <td>0.583333</td>
      <td>0.8125</td>
      <td>0.078550</td>
      <td>25</td>
      <td>2</td>
      <td>0.5</td>
      <td>0.600</td>
      <td>0.128340</td>
    </tr>
    <tr>
      <th>74</th>
      <td>Wheat Chex</td>
      <td>Other</td>
      <td>C</td>
      <td>0.454545</td>
      <td>0.4</td>
      <td>0.2</td>
      <td>0.718750</td>
      <td>0.214286</td>
      <td>0.750000</td>
      <td>0.2500</td>
      <td>0.350453</td>
      <td>25</td>
      <td>1</td>
      <td>0.5</td>
      <td>0.336</td>
      <td>0.419558</td>
    </tr>
    <tr>
      <th>75</th>
      <td>Wheaties</td>
      <td>G</td>
      <td>C</td>
      <td>0.454545</td>
      <td>0.4</td>
      <td>0.2</td>
      <td>0.625000</td>
      <td>0.214286</td>
      <td>0.750000</td>
      <td>0.2500</td>
      <td>0.335347</td>
      <td>25</td>
      <td>1</td>
      <td>0.5</td>
      <td>0.600</td>
      <td>0.443410</td>
    </tr>
    <tr>
      <th>76</th>
      <td>Wheaties Honey Gold</td>
      <td>G</td>
      <td>C</td>
      <td>0.545455</td>
      <td>0.2</td>
      <td>0.2</td>
      <td>0.625000</td>
      <td>0.071429</td>
      <td>0.708333</td>
      <td>0.5625</td>
      <td>0.184290</td>
      <td>25</td>
      <td>1</td>
      <td>0.5</td>
      <td>0.400</td>
      <td>0.239812</td>
    </tr>
  </tbody>
</table>
<p>77 rows × 16 columns</p>
</div></div></div>
</div>
</section>
<section id="one-hot-encoding-the-categorical-values">
<h4>One-Hot Encoding the categorical values<a class="headerlink" href="#one-hot-encoding-the-categorical-values" title="Permalink to this heading">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Next let&#39;s one-hot encode those categorical variables</span>

<span class="n">category_list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">cereal</span><span class="o">.</span><span class="n">select_dtypes</span><span class="p">(</span><span class="s1">&#39;category&#39;</span><span class="p">))</span> <span class="c1">#select function to find the categorical variables and create a list  </span>

<span class="n">cereal_1h</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">get_dummies</span><span class="p">(</span><span class="n">cereal</span><span class="p">,</span> <span class="n">columns</span> <span class="o">=</span> <span class="n">category_list</span><span class="p">)</span> 
<span class="c1">#get_dummies encodes categorical variables into binary by adding in indicator column for each group of a category </span>
<span class="c1">#and assigning it 0 if false or 1 if true</span>
<span class="n">cereal_1h</span> <span class="c1">#see the difference? This is one-hot encoding!</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>name</th>
      <th>calories</th>
      <th>protein</th>
      <th>fat</th>
      <th>sodium</th>
      <th>fiber</th>
      <th>carbo</th>
      <th>sugars</th>
      <th>potass</th>
      <th>weight</th>
      <th>...</th>
      <th>mfr_K</th>
      <th>mfr_Other</th>
      <th>type_C</th>
      <th>type_H</th>
      <th>vitamins_0</th>
      <th>vitamins_25</th>
      <th>vitamins_100</th>
      <th>shelf_1</th>
      <th>shelf_2</th>
      <th>shelf_3</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>100% Bran</td>
      <td>0.181818</td>
      <td>0.6</td>
      <td>0.2</td>
      <td>0.406250</td>
      <td>0.714286</td>
      <td>0.250000</td>
      <td>0.4375</td>
      <td>0.848943</td>
      <td>0.5</td>
      <td>...</td>
      <td>False</td>
      <td>True</td>
      <td>True</td>
      <td>False</td>
      <td>False</td>
      <td>True</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>True</td>
    </tr>
    <tr>
      <th>1</th>
      <td>100% Natural Bran</td>
      <td>0.636364</td>
      <td>0.4</td>
      <td>1.0</td>
      <td>0.046875</td>
      <td>0.142857</td>
      <td>0.375000</td>
      <td>0.5625</td>
      <td>0.410876</td>
      <td>0.5</td>
      <td>...</td>
      <td>False</td>
      <td>True</td>
      <td>True</td>
      <td>False</td>
      <td>True</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>True</td>
    </tr>
    <tr>
      <th>2</th>
      <td>All-Bran</td>
      <td>0.181818</td>
      <td>0.6</td>
      <td>0.2</td>
      <td>0.812500</td>
      <td>0.642857</td>
      <td>0.333333</td>
      <td>0.3750</td>
      <td>0.969789</td>
      <td>0.5</td>
      <td>...</td>
      <td>True</td>
      <td>False</td>
      <td>True</td>
      <td>False</td>
      <td>False</td>
      <td>True</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>True</td>
    </tr>
    <tr>
      <th>3</th>
      <td>All-Bran with Extra Fiber</td>
      <td>0.000000</td>
      <td>0.6</td>
      <td>0.0</td>
      <td>0.437500</td>
      <td>1.000000</td>
      <td>0.375000</td>
      <td>0.0625</td>
      <td>1.000000</td>
      <td>0.5</td>
      <td>...</td>
      <td>True</td>
      <td>False</td>
      <td>True</td>
      <td>False</td>
      <td>False</td>
      <td>True</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>True</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Almond Delight</td>
      <td>0.545455</td>
      <td>0.2</td>
      <td>0.4</td>
      <td>0.625000</td>
      <td>0.071429</td>
      <td>0.625000</td>
      <td>0.5625</td>
      <td>0.000000</td>
      <td>0.5</td>
      <td>...</td>
      <td>False</td>
      <td>True</td>
      <td>True</td>
      <td>False</td>
      <td>False</td>
      <td>True</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>True</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>72</th>
      <td>Triples</td>
      <td>0.545455</td>
      <td>0.2</td>
      <td>0.2</td>
      <td>0.781250</td>
      <td>0.000000</td>
      <td>0.916667</td>
      <td>0.2500</td>
      <td>0.184290</td>
      <td>0.5</td>
      <td>...</td>
      <td>False</td>
      <td>False</td>
      <td>True</td>
      <td>False</td>
      <td>False</td>
      <td>True</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>True</td>
    </tr>
    <tr>
      <th>73</th>
      <td>Trix</td>
      <td>0.545455</td>
      <td>0.0</td>
      <td>0.2</td>
      <td>0.437500</td>
      <td>0.000000</td>
      <td>0.583333</td>
      <td>0.8125</td>
      <td>0.078550</td>
      <td>0.5</td>
      <td>...</td>
      <td>False</td>
      <td>False</td>
      <td>True</td>
      <td>False</td>
      <td>False</td>
      <td>True</td>
      <td>False</td>
      <td>False</td>
      <td>True</td>
      <td>False</td>
    </tr>
    <tr>
      <th>74</th>
      <td>Wheat Chex</td>
      <td>0.454545</td>
      <td>0.4</td>
      <td>0.2</td>
      <td>0.718750</td>
      <td>0.214286</td>
      <td>0.750000</td>
      <td>0.2500</td>
      <td>0.350453</td>
      <td>0.5</td>
      <td>...</td>
      <td>False</td>
      <td>True</td>
      <td>True</td>
      <td>False</td>
      <td>False</td>
      <td>True</td>
      <td>False</td>
      <td>True</td>
      <td>False</td>
      <td>False</td>
    </tr>
    <tr>
      <th>75</th>
      <td>Wheaties</td>
      <td>0.454545</td>
      <td>0.4</td>
      <td>0.2</td>
      <td>0.625000</td>
      <td>0.214286</td>
      <td>0.750000</td>
      <td>0.2500</td>
      <td>0.335347</td>
      <td>0.5</td>
      <td>...</td>
      <td>False</td>
      <td>False</td>
      <td>True</td>
      <td>False</td>
      <td>False</td>
      <td>True</td>
      <td>False</td>
      <td>True</td>
      <td>False</td>
      <td>False</td>
    </tr>
    <tr>
      <th>76</th>
      <td>Wheaties Honey Gold</td>
      <td>0.545455</td>
      <td>0.2</td>
      <td>0.2</td>
      <td>0.625000</td>
      <td>0.071429</td>
      <td>0.708333</td>
      <td>0.5625</td>
      <td>0.184290</td>
      <td>0.5</td>
      <td>...</td>
      <td>False</td>
      <td>False</td>
      <td>True</td>
      <td>False</td>
      <td>False</td>
      <td>True</td>
      <td>False</td>
      <td>True</td>
      <td>False</td>
      <td>False</td>
    </tr>
  </tbody>
</table>
<p>77 rows × 23 columns</p>
</div></div></div>
</div>
</section>
<section id="creating-a-binary-target-variable-so-we-can-run-this-model-as-a-classification-problem">
<h4>Creating a binary target variable so we can run this model as a classification problem.<a class="headerlink" href="#creating-a-binary-target-variable-so-we-can-run-this-model-as-a-classification-problem" title="Permalink to this heading">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#add this as a predictor instead of replacing the numeric version, changing the target into a binary variable </span>
<span class="c1">#to allow for classification </span>
<span class="n">cereal_1h</span><span class="p">[</span><span class="s1">&#39;rating_f&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">cut</span><span class="p">(</span><span class="n">cereal_1h</span><span class="o">.</span><span class="n">rating</span><span class="p">,</span> <span class="n">bins</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mf">0.43</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="n">labels</span> <span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="c1">#If we want two segments we input three numbers, start, cut and stop values</span>

<span class="n">cereal_1h</span> <span class="c1">#notice the new column rating_f, it is now binary based on if the continuous value is above 0.43 or not</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>name</th>
      <th>calories</th>
      <th>protein</th>
      <th>fat</th>
      <th>sodium</th>
      <th>fiber</th>
      <th>carbo</th>
      <th>sugars</th>
      <th>potass</th>
      <th>weight</th>
      <th>...</th>
      <th>mfr_Other</th>
      <th>type_C</th>
      <th>type_H</th>
      <th>vitamins_0</th>
      <th>vitamins_25</th>
      <th>vitamins_100</th>
      <th>shelf_1</th>
      <th>shelf_2</th>
      <th>shelf_3</th>
      <th>rating_f</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>100% Bran</td>
      <td>0.181818</td>
      <td>0.6</td>
      <td>0.2</td>
      <td>0.406250</td>
      <td>0.714286</td>
      <td>0.250000</td>
      <td>0.4375</td>
      <td>0.848943</td>
      <td>0.5</td>
      <td>...</td>
      <td>True</td>
      <td>True</td>
      <td>False</td>
      <td>False</td>
      <td>True</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>True</td>
      <td>1</td>
    </tr>
    <tr>
      <th>1</th>
      <td>100% Natural Bran</td>
      <td>0.636364</td>
      <td>0.4</td>
      <td>1.0</td>
      <td>0.046875</td>
      <td>0.142857</td>
      <td>0.375000</td>
      <td>0.5625</td>
      <td>0.410876</td>
      <td>0.5</td>
      <td>...</td>
      <td>True</td>
      <td>True</td>
      <td>False</td>
      <td>True</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>True</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>All-Bran</td>
      <td>0.181818</td>
      <td>0.6</td>
      <td>0.2</td>
      <td>0.812500</td>
      <td>0.642857</td>
      <td>0.333333</td>
      <td>0.3750</td>
      <td>0.969789</td>
      <td>0.5</td>
      <td>...</td>
      <td>False</td>
      <td>True</td>
      <td>False</td>
      <td>False</td>
      <td>True</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>True</td>
      <td>1</td>
    </tr>
    <tr>
      <th>3</th>
      <td>All-Bran with Extra Fiber</td>
      <td>0.000000</td>
      <td>0.6</td>
      <td>0.0</td>
      <td>0.437500</td>
      <td>1.000000</td>
      <td>0.375000</td>
      <td>0.0625</td>
      <td>1.000000</td>
      <td>0.5</td>
      <td>...</td>
      <td>False</td>
      <td>True</td>
      <td>False</td>
      <td>False</td>
      <td>True</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>True</td>
      <td>1</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Almond Delight</td>
      <td>0.545455</td>
      <td>0.2</td>
      <td>0.4</td>
      <td>0.625000</td>
      <td>0.071429</td>
      <td>0.625000</td>
      <td>0.5625</td>
      <td>0.000000</td>
      <td>0.5</td>
      <td>...</td>
      <td>True</td>
      <td>True</td>
      <td>False</td>
      <td>False</td>
      <td>True</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>True</td>
      <td>0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>72</th>
      <td>Triples</td>
      <td>0.545455</td>
      <td>0.2</td>
      <td>0.2</td>
      <td>0.781250</td>
      <td>0.000000</td>
      <td>0.916667</td>
      <td>0.2500</td>
      <td>0.184290</td>
      <td>0.5</td>
      <td>...</td>
      <td>False</td>
      <td>True</td>
      <td>False</td>
      <td>False</td>
      <td>True</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>True</td>
      <td>0</td>
    </tr>
    <tr>
      <th>73</th>
      <td>Trix</td>
      <td>0.545455</td>
      <td>0.0</td>
      <td>0.2</td>
      <td>0.437500</td>
      <td>0.000000</td>
      <td>0.583333</td>
      <td>0.8125</td>
      <td>0.078550</td>
      <td>0.5</td>
      <td>...</td>
      <td>False</td>
      <td>True</td>
      <td>False</td>
      <td>False</td>
      <td>True</td>
      <td>False</td>
      <td>False</td>
      <td>True</td>
      <td>False</td>
      <td>0</td>
    </tr>
    <tr>
      <th>74</th>
      <td>Wheat Chex</td>
      <td>0.454545</td>
      <td>0.4</td>
      <td>0.2</td>
      <td>0.718750</td>
      <td>0.214286</td>
      <td>0.750000</td>
      <td>0.2500</td>
      <td>0.350453</td>
      <td>0.5</td>
      <td>...</td>
      <td>True</td>
      <td>True</td>
      <td>False</td>
      <td>False</td>
      <td>True</td>
      <td>False</td>
      <td>True</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
    </tr>
    <tr>
      <th>75</th>
      <td>Wheaties</td>
      <td>0.454545</td>
      <td>0.4</td>
      <td>0.2</td>
      <td>0.625000</td>
      <td>0.214286</td>
      <td>0.750000</td>
      <td>0.2500</td>
      <td>0.335347</td>
      <td>0.5</td>
      <td>...</td>
      <td>False</td>
      <td>True</td>
      <td>False</td>
      <td>False</td>
      <td>True</td>
      <td>False</td>
      <td>True</td>
      <td>False</td>
      <td>False</td>
      <td>1</td>
    </tr>
    <tr>
      <th>76</th>
      <td>Wheaties Honey Gold</td>
      <td>0.545455</td>
      <td>0.2</td>
      <td>0.2</td>
      <td>0.625000</td>
      <td>0.071429</td>
      <td>0.708333</td>
      <td>0.5625</td>
      <td>0.184290</td>
      <td>0.5</td>
      <td>...</td>
      <td>False</td>
      <td>True</td>
      <td>False</td>
      <td>False</td>
      <td>True</td>
      <td>False</td>
      <td>True</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
<p>77 rows × 24 columns</p>
</div></div></div>
</div>
</section>
<section id="dropping-variables-and-partitioning-train-test">
<h4>Dropping Variables and Partitioning (Train/Test)<a class="headerlink" href="#dropping-variables-and-partitioning-train-test" title="Permalink to this heading">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Divide up our data into two parts, Training and Test but first we need to...</span>
<span class="c1">#clean up our dataset a bit by dropping the original rating variable and the cereal name since we can&#39;t really use them</span>

<span class="n">cereal_dt</span> <span class="o">=</span> <span class="n">cereal_1h</span><span class="o">.</span><span class="n">drop</span><span class="p">([</span><span class="s1">&#39;name&#39;</span><span class="p">,</span><span class="s1">&#39;rating&#39;</span><span class="p">],</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> <span class="c1">#creating a new dataframe so we don&#39;t delete these columns from our working environment. </span>
<span class="n">cereal_dt</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>calories</th>
      <th>protein</th>
      <th>fat</th>
      <th>sodium</th>
      <th>fiber</th>
      <th>carbo</th>
      <th>sugars</th>
      <th>potass</th>
      <th>weight</th>
      <th>cups</th>
      <th>...</th>
      <th>mfr_Other</th>
      <th>type_C</th>
      <th>type_H</th>
      <th>vitamins_0</th>
      <th>vitamins_25</th>
      <th>vitamins_100</th>
      <th>shelf_1</th>
      <th>shelf_2</th>
      <th>shelf_3</th>
      <th>rating_f</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.181818</td>
      <td>0.6</td>
      <td>0.2</td>
      <td>0.406250</td>
      <td>0.714286</td>
      <td>0.250000</td>
      <td>0.4375</td>
      <td>0.848943</td>
      <td>0.5</td>
      <td>0.064</td>
      <td>...</td>
      <td>True</td>
      <td>True</td>
      <td>False</td>
      <td>False</td>
      <td>True</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>True</td>
      <td>1</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.636364</td>
      <td>0.4</td>
      <td>1.0</td>
      <td>0.046875</td>
      <td>0.142857</td>
      <td>0.375000</td>
      <td>0.5625</td>
      <td>0.410876</td>
      <td>0.5</td>
      <td>0.600</td>
      <td>...</td>
      <td>True</td>
      <td>True</td>
      <td>False</td>
      <td>True</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>True</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.181818</td>
      <td>0.6</td>
      <td>0.2</td>
      <td>0.812500</td>
      <td>0.642857</td>
      <td>0.333333</td>
      <td>0.3750</td>
      <td>0.969789</td>
      <td>0.5</td>
      <td>0.064</td>
      <td>...</td>
      <td>False</td>
      <td>True</td>
      <td>False</td>
      <td>False</td>
      <td>True</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>True</td>
      <td>1</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.000000</td>
      <td>0.6</td>
      <td>0.0</td>
      <td>0.437500</td>
      <td>1.000000</td>
      <td>0.375000</td>
      <td>0.0625</td>
      <td>1.000000</td>
      <td>0.5</td>
      <td>0.200</td>
      <td>...</td>
      <td>False</td>
      <td>True</td>
      <td>False</td>
      <td>False</td>
      <td>True</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>True</td>
      <td>1</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0.545455</td>
      <td>0.2</td>
      <td>0.4</td>
      <td>0.625000</td>
      <td>0.071429</td>
      <td>0.625000</td>
      <td>0.5625</td>
      <td>0.000000</td>
      <td>0.5</td>
      <td>0.400</td>
      <td>...</td>
      <td>True</td>
      <td>True</td>
      <td>False</td>
      <td>False</td>
      <td>True</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>True</td>
      <td>0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>72</th>
      <td>0.545455</td>
      <td>0.2</td>
      <td>0.2</td>
      <td>0.781250</td>
      <td>0.000000</td>
      <td>0.916667</td>
      <td>0.2500</td>
      <td>0.184290</td>
      <td>0.5</td>
      <td>0.400</td>
      <td>...</td>
      <td>False</td>
      <td>True</td>
      <td>False</td>
      <td>False</td>
      <td>True</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>True</td>
      <td>0</td>
    </tr>
    <tr>
      <th>73</th>
      <td>0.545455</td>
      <td>0.0</td>
      <td>0.2</td>
      <td>0.437500</td>
      <td>0.000000</td>
      <td>0.583333</td>
      <td>0.8125</td>
      <td>0.078550</td>
      <td>0.5</td>
      <td>0.600</td>
      <td>...</td>
      <td>False</td>
      <td>True</td>
      <td>False</td>
      <td>False</td>
      <td>True</td>
      <td>False</td>
      <td>False</td>
      <td>True</td>
      <td>False</td>
      <td>0</td>
    </tr>
    <tr>
      <th>74</th>
      <td>0.454545</td>
      <td>0.4</td>
      <td>0.2</td>
      <td>0.718750</td>
      <td>0.214286</td>
      <td>0.750000</td>
      <td>0.2500</td>
      <td>0.350453</td>
      <td>0.5</td>
      <td>0.336</td>
      <td>...</td>
      <td>True</td>
      <td>True</td>
      <td>False</td>
      <td>False</td>
      <td>True</td>
      <td>False</td>
      <td>True</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
    </tr>
    <tr>
      <th>75</th>
      <td>0.454545</td>
      <td>0.4</td>
      <td>0.2</td>
      <td>0.625000</td>
      <td>0.214286</td>
      <td>0.750000</td>
      <td>0.2500</td>
      <td>0.335347</td>
      <td>0.5</td>
      <td>0.600</td>
      <td>...</td>
      <td>False</td>
      <td>True</td>
      <td>False</td>
      <td>False</td>
      <td>True</td>
      <td>False</td>
      <td>True</td>
      <td>False</td>
      <td>False</td>
      <td>1</td>
    </tr>
    <tr>
      <th>76</th>
      <td>0.545455</td>
      <td>0.2</td>
      <td>0.2</td>
      <td>0.625000</td>
      <td>0.071429</td>
      <td>0.708333</td>
      <td>0.5625</td>
      <td>0.184290</td>
      <td>0.5</td>
      <td>0.400</td>
      <td>...</td>
      <td>False</td>
      <td>True</td>
      <td>False</td>
      <td>False</td>
      <td>True</td>
      <td>False</td>
      <td>True</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
<p>77 rows × 22 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Now we partition</span>
<span class="n">Train</span><span class="p">,</span> <span class="n">Test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">cereal_dt</span><span class="p">,</span>  <span class="n">train_size</span> <span class="o">=</span> <span class="mi">55</span><span class="p">,</span> <span class="n">stratify</span> <span class="o">=</span> <span class="n">cereal_dt</span><span class="o">.</span><span class="n">rating_f</span><span class="p">)</span> 
<span class="c1">#stratify perserves class proportions when splitting, reducing sampling error </span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="model-building-cell">
<h4>Model Building Cell<a class="headerlink" href="#model-building-cell" title="Permalink to this heading">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">random</span>
<span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">1984</span><span class="p">)</span>   <span class="c1"># kNN is a random algorithm, so we use `random.seed(x)` to make results repeatable</span>

<span class="n">X_train</span> <span class="o">=</span> <span class="n">Train</span><span class="o">.</span><span class="n">drop</span><span class="p">([</span><span class="s1">&#39;rating_f&#39;</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">values</span> <span class="c1">#features</span>
<span class="n">y_train</span> <span class="o">=</span> <span class="n">Train</span><span class="p">[</span><span class="s1">&#39;rating_f&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span> <span class="c1">#target</span>

<span class="n">neigh</span> <span class="o">=</span> <span class="n">KNeighborsClassifier</span><span class="p">(</span><span class="n">n_neighbors</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span> <span class="c1">#this is the value to change</span>
<span class="n">neigh</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><style>#sk-container-id-1 {color: black;background-color: white;}#sk-container-id-1 pre{padding: 0;}#sk-container-id-1 div.sk-toggleable {background-color: white;}#sk-container-id-1 label.sk-toggleable__label {cursor: pointer;display: block;width: 100%;margin-bottom: 0;padding: 0.3em;box-sizing: border-box;text-align: center;}#sk-container-id-1 label.sk-toggleable__label-arrow:before {content: "▸";float: left;margin-right: 0.25em;color: #696969;}#sk-container-id-1 label.sk-toggleable__label-arrow:hover:before {color: black;}#sk-container-id-1 div.sk-estimator:hover label.sk-toggleable__label-arrow:before {color: black;}#sk-container-id-1 div.sk-toggleable__content {max-height: 0;max-width: 0;overflow: hidden;text-align: left;background-color: #f0f8ff;}#sk-container-id-1 div.sk-toggleable__content pre {margin: 0.2em;color: black;border-radius: 0.25em;background-color: #f0f8ff;}#sk-container-id-1 input.sk-toggleable__control:checked~div.sk-toggleable__content {max-height: 200px;max-width: 100%;overflow: auto;}#sk-container-id-1 input.sk-toggleable__control:checked~label.sk-toggleable__label-arrow:before {content: "▾";}#sk-container-id-1 div.sk-estimator input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-1 div.sk-label input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-1 input.sk-hidden--visually {border: 0;clip: rect(1px 1px 1px 1px);clip: rect(1px, 1px, 1px, 1px);height: 1px;margin: -1px;overflow: hidden;padding: 0;position: absolute;width: 1px;}#sk-container-id-1 div.sk-estimator {font-family: monospace;background-color: #f0f8ff;border: 1px dotted black;border-radius: 0.25em;box-sizing: border-box;margin-bottom: 0.5em;}#sk-container-id-1 div.sk-estimator:hover {background-color: #d4ebff;}#sk-container-id-1 div.sk-parallel-item::after {content: "";width: 100%;border-bottom: 1px solid gray;flex-grow: 1;}#sk-container-id-1 div.sk-label:hover label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-1 div.sk-serial::before {content: "";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: 0;}#sk-container-id-1 div.sk-serial {display: flex;flex-direction: column;align-items: center;background-color: white;padding-right: 0.2em;padding-left: 0.2em;position: relative;}#sk-container-id-1 div.sk-item {position: relative;z-index: 1;}#sk-container-id-1 div.sk-parallel {display: flex;align-items: stretch;justify-content: center;background-color: white;position: relative;}#sk-container-id-1 div.sk-item::before, #sk-container-id-1 div.sk-parallel-item::before {content: "";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: -1;}#sk-container-id-1 div.sk-parallel-item {display: flex;flex-direction: column;z-index: 1;position: relative;background-color: white;}#sk-container-id-1 div.sk-parallel-item:first-child::after {align-self: flex-end;width: 50%;}#sk-container-id-1 div.sk-parallel-item:last-child::after {align-self: flex-start;width: 50%;}#sk-container-id-1 div.sk-parallel-item:only-child::after {width: 0;}#sk-container-id-1 div.sk-dashed-wrapped {border: 1px dashed gray;margin: 0 0.4em 0.5em 0.4em;box-sizing: border-box;padding-bottom: 0.4em;background-color: white;}#sk-container-id-1 div.sk-label label {font-family: monospace;font-weight: bold;display: inline-block;line-height: 1.2em;}#sk-container-id-1 div.sk-label-container {text-align: center;}#sk-container-id-1 div.sk-container {/* jupyter's `normalize.less` sets `[hidden] { display: none; }` but bootstrap.min.css set `[hidden] { display: none !important; }` so we also need the `!important` here to be able to override the default hidden behavior on the sphinx rendered scikit-learn.org. See: https://github.com/scikit-learn/scikit-learn/issues/21755 */display: inline-block !important;position: relative;}#sk-container-id-1 div.sk-text-repr-fallback {display: none;}</style><div id="sk-container-id-1" class="sk-top-container"><div class="sk-text-repr-fallback"><pre>KNeighborsClassifier(n_neighbors=3)</pre><b>In a Jupyter environment, please rerun this cell to show the HTML representation or trust the notebook. <br />On GitHub, the HTML representation is unable to render, please try loading this page with nbviewer.org.</b></div><div class="sk-container" hidden><div class="sk-item"><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-1" type="checkbox" checked><label for="sk-estimator-id-1" class="sk-toggleable__label sk-toggleable__label-arrow">KNeighborsClassifier</label><div class="sk-toggleable__content"><pre>KNeighborsClassifier(n_neighbors=3)</pre></div></div></div></div></div></div></div>
</div>
</section>
<section id="evaluation-cell">
<h4>Evaluation Cell<a class="headerlink" href="#evaluation-cell" title="Permalink to this heading">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">X_test</span> <span class="o">=</span> <span class="n">Test</span><span class="o">.</span><span class="n">drop</span><span class="p">([</span><span class="s1">&#39;rating_f&#39;</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">values</span>
<span class="n">y_test</span> <span class="o">=</span> <span class="n">Test</span><span class="p">[</span><span class="s1">&#39;rating_f&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>

<span class="n">neigh</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.5909090909090909
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="task-1">
<h3>Task 1<a class="headerlink" href="#task-1" title="Permalink to this heading">#</a></h3>
<ol class="arabic simple">
<li><p>Go back two cells to the “Model Building Cell” and change the value of k. Then rerun the “Evaluation cell”. What happens to the accuracy of the model? Track the output of the model for odd values between 3 and 21. Note the changes by drawing a graph, by hand, of the <em>accuracy</em> versus k.</p></li>
<li><p>Using what we learning in class about over and under fitting explain what is happening to the model as we change the value of k, keeping in mind that the range of evaluation is between 0 and 1, with 1 being a perfect classification model.</p></li>
<li><p>Lastly recommend a value for k and explain why you recommend that value.</p></li>
</ol>
</section>
<section id="part-2-probabilities-of-the-model">
<h3>Part 2: Probabilities of the Model<a class="headerlink" href="#part-2-probabilities-of-the-model" title="Permalink to this heading">#</a></h3>
<p><strong>The model is predicting the probability of each observation belonging to each class. So for every row in the test dataset a probability is calculated for each class [0,1]. The class with the highest probability is the predicted class. So let’s take a closer look at the probabilities. The next five cells are just getting the data organized so the results are easier to view.</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># we want to make a table containing: probability, expected, and actual values</span>

<span class="n">test_probs</span> <span class="o">=</span> <span class="n">neigh</span><span class="o">.</span><span class="n">predict_proba</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
<span class="n">test_preds</span> <span class="o">=</span> <span class="n">neigh</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># convert probabilities to pd df</span>
<span class="n">test_probabilities</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">test_probs</span><span class="p">,</span> <span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;bad_cereal_prob&#39;</span><span class="p">,</span> <span class="s1">&#39;good_cereal_prob&#39;</span><span class="p">])</span>
<span class="n">test_probabilities</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>bad_cereal_prob</th>
      <th>good_cereal_prob</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1.000000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1.000000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.666667</td>
      <td>0.333333</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1.000000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0.333333</td>
      <td>0.666667</td>
    </tr>
    <tr>
      <th>5</th>
      <td>1.000000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>6</th>
      <td>1.000000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>7</th>
      <td>1.000000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>8</th>
      <td>1.000000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>9</th>
      <td>0.000000</td>
      <td>1.000000</td>
    </tr>
    <tr>
      <th>10</th>
      <td>1.000000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>11</th>
      <td>0.333333</td>
      <td>0.666667</td>
    </tr>
    <tr>
      <th>12</th>
      <td>1.000000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>13</th>
      <td>0.000000</td>
      <td>1.000000</td>
    </tr>
    <tr>
      <th>14</th>
      <td>1.000000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>15</th>
      <td>1.000000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>16</th>
      <td>0.333333</td>
      <td>0.666667</td>
    </tr>
    <tr>
      <th>17</th>
      <td>0.666667</td>
      <td>0.333333</td>
    </tr>
    <tr>
      <th>18</th>
      <td>1.000000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>19</th>
      <td>0.666667</td>
      <td>0.333333</td>
    </tr>
    <tr>
      <th>20</th>
      <td>0.666667</td>
      <td>0.333333</td>
    </tr>
    <tr>
      <th>21</th>
      <td>1.000000</td>
      <td>0.000000</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">final_model</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;actual_class&#39;</span><span class="p">:</span> <span class="n">y_test</span><span class="o">.</span><span class="n">tolist</span><span class="p">(),</span>
                           <span class="s1">&#39;pred_class&#39;</span><span class="p">:</span> <span class="n">test_preds</span><span class="o">.</span><span class="n">tolist</span><span class="p">(),</span>
                           <span class="s1">&#39;pred_prob&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">test_probabilities</span><span class="p">[</span><span class="s1">&#39;good_cereal_prob&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="k">if</span> <span class="n">test_preds</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">==</span><span class="mi">1</span> <span class="k">else</span> <span class="n">test_probabilities</span><span class="p">[</span><span class="s1">&#39;bad_cereal_prob&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">test_preds</span><span class="p">))]})</span>
<span class="c1"># that last line is some list comprehension -- to understand that here in particular click the following link:</span>
<span class="c1"># https://stackoverflow.com/questions/4260280/if-else-in-a-list-comprehension</span>

<span class="n">final_model</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>actual_class</th>
      <th>pred_class</th>
      <th>pred_prob</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>0</td>
      <td>1.000000</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0</td>
      <td>0</td>
      <td>1.000000</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1</td>
      <td>0</td>
      <td>0.666667</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0</td>
      <td>0</td>
      <td>1.000000</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0</td>
      <td>1</td>
      <td>0.666667</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<section id="now-we-are-going-to-add-the-percentage-of-the-probability-for-the-positive-class-good-cereal-to-the-dataframe">
<h4>Now we are going to add the percentage of the probability for the positive class (good cereal) to the dataframe.<a class="headerlink" href="#now-we-are-going-to-add-the-percentage-of-the-probability-for-the-positive-class-good-cereal-to-the-dataframe" title="Permalink to this heading">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># add a column about the probability the observation is in the positive class</span>
<span class="n">final_model</span><span class="p">[</span><span class="s1">&#39;pos_pred&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">final_model</span><span class="o">.</span><span class="n">pred_prob</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">if</span> <span class="n">final_model</span><span class="o">.</span><span class="n">pred_class</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">==</span><span class="mi">1</span> <span class="k">else</span> <span class="mi">1</span><span class="o">-</span><span class="n">final_model</span><span class="o">.</span><span class="n">pred_prob</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">final_model</span><span class="o">.</span><span class="n">pred_class</span><span class="p">))]</span>

<span class="n">final_model</span> <span class="c1">#look at this dataframe for the first question in Task 2</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>actual_class</th>
      <th>pred_class</th>
      <th>pred_prob</th>
      <th>pos_pred</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>0</td>
      <td>1.000000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0</td>
      <td>0</td>
      <td>1.000000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1</td>
      <td>0</td>
      <td>0.666667</td>
      <td>0.333333</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0</td>
      <td>0</td>
      <td>1.000000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0</td>
      <td>1</td>
      <td>0.666667</td>
      <td>0.666667</td>
    </tr>
    <tr>
      <th>5</th>
      <td>0</td>
      <td>0</td>
      <td>1.000000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>6</th>
      <td>0</td>
      <td>0</td>
      <td>1.000000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>7</th>
      <td>0</td>
      <td>0</td>
      <td>1.000000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>8</th>
      <td>1</td>
      <td>0</td>
      <td>1.000000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>9</th>
      <td>1</td>
      <td>1</td>
      <td>1.000000</td>
      <td>1.000000</td>
    </tr>
    <tr>
      <th>10</th>
      <td>1</td>
      <td>0</td>
      <td>1.000000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>11</th>
      <td>0</td>
      <td>1</td>
      <td>0.666667</td>
      <td>0.666667</td>
    </tr>
    <tr>
      <th>12</th>
      <td>0</td>
      <td>0</td>
      <td>1.000000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>13</th>
      <td>0</td>
      <td>1</td>
      <td>1.000000</td>
      <td>1.000000</td>
    </tr>
    <tr>
      <th>14</th>
      <td>0</td>
      <td>0</td>
      <td>1.000000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>15</th>
      <td>0</td>
      <td>0</td>
      <td>1.000000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>16</th>
      <td>0</td>
      <td>1</td>
      <td>0.666667</td>
      <td>0.666667</td>
    </tr>
    <tr>
      <th>17</th>
      <td>0</td>
      <td>0</td>
      <td>0.666667</td>
      <td>0.333333</td>
    </tr>
    <tr>
      <th>18</th>
      <td>0</td>
      <td>0</td>
      <td>1.000000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>19</th>
      <td>0</td>
      <td>0</td>
      <td>0.666667</td>
      <td>0.333333</td>
    </tr>
    <tr>
      <th>20</th>
      <td>1</td>
      <td>0</td>
      <td>0.666667</td>
      <td>0.333333</td>
    </tr>
    <tr>
      <th>21</th>
      <td>1</td>
      <td>0</td>
      <td>1.000000</td>
      <td>0.000000</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># convert classes to categories</span>
<span class="n">final_model</span><span class="o">.</span><span class="n">actual_class</span> <span class="o">=</span> <span class="n">final_model</span><span class="o">.</span><span class="n">actual_class</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;category&#39;</span><span class="p">)</span>
<span class="n">final_model</span><span class="o">.</span><span class="n">pred_class</span> <span class="o">=</span> <span class="n">final_model</span><span class="o">.</span><span class="n">pred_class</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;category&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="graph-the-probabilities">
<h4>Graph the probabilities<a class="headerlink" href="#graph-the-probabilities" title="Permalink to this heading">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># create probability distribution graph</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>

<span class="n">sns</span><span class="o">.</span><span class="n">histplot</span><span class="p">(</span><span class="n">final_model</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s2">&quot;pos_pred&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;Axes: xlabel=&#39;pos_pred&#39;, ylabel=&#39;Count&#39;&gt;
</pre></div>
</div>
<img alt="../_images/0badc8a06a6d20ee030108eab1373e2b7b3ffdb653e2c3df7eff681be5126d38.png" src="../_images/0badc8a06a6d20ee030108eab1373e2b7b3ffdb653e2c3df7eff681be5126d38.png" />
</div>
</div>
</section>
</section>
<section id="task-2-determine-how-the-probabilities-are-calculated">
<h3>Task 2: Determine how the probabilities are calculated<a class="headerlink" href="#task-2-determine-how-the-probabilities-are-calculated" title="Permalink to this heading">#</a></h3>
<ol class="arabic simple">
<li><p>First, looking at the “final model” dataframe from three cells above, list the rows that have errors in the classification.</p></li>
<li><p>Use the code below to again adjust the k value in the “Second Model Building Cell” and the run the “Graph Cell”. Use the same range of values as you did in Task 1. This time look at the graph and note the changes. Then based on what you are seeing determine how the probabilities are being generated.</p></li>
<li><p>Lastly, the model will predict anything above 50% as the positive class (good cereal). Given this information what are the risks of having too small of a k value?</p></li>
</ol>
<section id="second-model-building-cell">
<h4>Second Model Building Cell<a class="headerlink" href="#second-model-building-cell" title="Permalink to this heading">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">1984</span><span class="p">)</span>   <span class="c1"># kNN is a random algorithm, so we use `random.seed(x)` to make results repeatable</span>

<span class="n">X_train</span> <span class="o">=</span> <span class="n">Train</span><span class="o">.</span><span class="n">drop</span><span class="p">([</span><span class="s1">&#39;rating_f&#39;</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">values</span> <span class="c1">#features</span>
<span class="n">y_train</span> <span class="o">=</span> <span class="n">Train</span><span class="p">[</span><span class="s1">&#39;rating_f&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span> <span class="c1">#target</span>

<span class="n">neigh</span> <span class="o">=</span> <span class="n">KNeighborsClassifier</span><span class="p">(</span><span class="n">n_neighbors</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span> <span class="c1">#this is the value to change</span>
<span class="n">neigh</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><style>#sk-container-id-2 {color: black;background-color: white;}#sk-container-id-2 pre{padding: 0;}#sk-container-id-2 div.sk-toggleable {background-color: white;}#sk-container-id-2 label.sk-toggleable__label {cursor: pointer;display: block;width: 100%;margin-bottom: 0;padding: 0.3em;box-sizing: border-box;text-align: center;}#sk-container-id-2 label.sk-toggleable__label-arrow:before {content: "▸";float: left;margin-right: 0.25em;color: #696969;}#sk-container-id-2 label.sk-toggleable__label-arrow:hover:before {color: black;}#sk-container-id-2 div.sk-estimator:hover label.sk-toggleable__label-arrow:before {color: black;}#sk-container-id-2 div.sk-toggleable__content {max-height: 0;max-width: 0;overflow: hidden;text-align: left;background-color: #f0f8ff;}#sk-container-id-2 div.sk-toggleable__content pre {margin: 0.2em;color: black;border-radius: 0.25em;background-color: #f0f8ff;}#sk-container-id-2 input.sk-toggleable__control:checked~div.sk-toggleable__content {max-height: 200px;max-width: 100%;overflow: auto;}#sk-container-id-2 input.sk-toggleable__control:checked~label.sk-toggleable__label-arrow:before {content: "▾";}#sk-container-id-2 div.sk-estimator input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-2 div.sk-label input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-2 input.sk-hidden--visually {border: 0;clip: rect(1px 1px 1px 1px);clip: rect(1px, 1px, 1px, 1px);height: 1px;margin: -1px;overflow: hidden;padding: 0;position: absolute;width: 1px;}#sk-container-id-2 div.sk-estimator {font-family: monospace;background-color: #f0f8ff;border: 1px dotted black;border-radius: 0.25em;box-sizing: border-box;margin-bottom: 0.5em;}#sk-container-id-2 div.sk-estimator:hover {background-color: #d4ebff;}#sk-container-id-2 div.sk-parallel-item::after {content: "";width: 100%;border-bottom: 1px solid gray;flex-grow: 1;}#sk-container-id-2 div.sk-label:hover label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-2 div.sk-serial::before {content: "";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: 0;}#sk-container-id-2 div.sk-serial {display: flex;flex-direction: column;align-items: center;background-color: white;padding-right: 0.2em;padding-left: 0.2em;position: relative;}#sk-container-id-2 div.sk-item {position: relative;z-index: 1;}#sk-container-id-2 div.sk-parallel {display: flex;align-items: stretch;justify-content: center;background-color: white;position: relative;}#sk-container-id-2 div.sk-item::before, #sk-container-id-2 div.sk-parallel-item::before {content: "";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: -1;}#sk-container-id-2 div.sk-parallel-item {display: flex;flex-direction: column;z-index: 1;position: relative;background-color: white;}#sk-container-id-2 div.sk-parallel-item:first-child::after {align-self: flex-end;width: 50%;}#sk-container-id-2 div.sk-parallel-item:last-child::after {align-self: flex-start;width: 50%;}#sk-container-id-2 div.sk-parallel-item:only-child::after {width: 0;}#sk-container-id-2 div.sk-dashed-wrapped {border: 1px dashed gray;margin: 0 0.4em 0.5em 0.4em;box-sizing: border-box;padding-bottom: 0.4em;background-color: white;}#sk-container-id-2 div.sk-label label {font-family: monospace;font-weight: bold;display: inline-block;line-height: 1.2em;}#sk-container-id-2 div.sk-label-container {text-align: center;}#sk-container-id-2 div.sk-container {/* jupyter's `normalize.less` sets `[hidden] { display: none; }` but bootstrap.min.css set `[hidden] { display: none !important; }` so we also need the `!important` here to be able to override the default hidden behavior on the sphinx rendered scikit-learn.org. See: https://github.com/scikit-learn/scikit-learn/issues/21755 */display: inline-block !important;position: relative;}#sk-container-id-2 div.sk-text-repr-fallback {display: none;}</style><div id="sk-container-id-2" class="sk-top-container"><div class="sk-text-repr-fallback"><pre>KNeighborsClassifier()</pre><b>In a Jupyter environment, please rerun this cell to show the HTML representation or trust the notebook. <br />On GitHub, the HTML representation is unable to render, please try loading this page with nbviewer.org.</b></div><div class="sk-container" hidden><div class="sk-item"><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-2" type="checkbox" checked><label for="sk-estimator-id-2" class="sk-toggleable__label sk-toggleable__label-arrow">KNeighborsClassifier</label><div class="sk-toggleable__content"><pre>KNeighborsClassifier()</pre></div></div></div></div></div></div></div>
</div>
</section>
<section id="graph-cell">
<h4>Graph Cell<a class="headerlink" href="#graph-cell" title="Permalink to this heading">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">test_probs_1</span> <span class="o">=</span> <span class="n">neigh</span><span class="o">.</span><span class="n">predict_proba</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>

<span class="c1">#converting to a dataframe to make seaborn happy</span>
<span class="n">test_probs_1</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">test_probs_1</span><span class="p">,</span> <span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;bad_cereal_prob&#39;</span><span class="p">,</span> <span class="s1">&#39;good_cereal_prob&#39;</span><span class="p">])</span>

<span class="c1">#gnerates the plot</span>
<span class="n">sns</span><span class="o">.</span><span class="n">histplot</span><span class="p">(</span><span class="n">test_probs_1</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span> <span class="s2">&quot;good_cereal_prob&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;Axes: xlabel=&#39;good_cereal_prob&#39;, ylabel=&#39;Count&#39;&gt;
</pre></div>
</div>
<img alt="../_images/6b9f352640ee713a1c861d54ee2ee8c746f684dfc088b09ecb211ecc413ab472.png" src="../_images/6b9f352640ee713a1c861d54ee2ee8c746f684dfc088b09ecb211ecc413ab472.png" />
</div>
</div>
</section>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./Analytics"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
                <footer class="bd-footer-article">
                  
<div class="footer-article-items footer-article__inner">
  
    <div class="footer-article-item"><!-- Previous / next buttons -->
<div class="prev-next-area">
    <a class="left-prev"
       href="Instructional-Intro.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Instructional Materials</p>
      </div>
    </a>
    <a class="right-next"
       href="Analytics_Case.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Analytics CASE Study</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div></div>
  
</div>

                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#lab-1-mastermind-entropy">Lab 1 - Mastermind entropy</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#lab-2-garbage-in-garbage-out">Lab 2 - Garbage In Garbage Out</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#let-s-take-a-quick-look-at-a-scatter-plot-to-get-an-idea-of-the-distribution-of-the-data">Let’s take a quick look at a scatter plot to get an idea of the distribution of the data.</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#next-lets-build-a-linear-regression-model-to-predict-eruption-length-based-on-waiting-time">Next lets build a linear regression model to predict Eruption Length based on Waiting Time</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#now-we-are-creating-noise-that-aligns-to-a-normal-or-gaussian-distribution-thus-gaussian-noise-to-add-to-the-data">Now we are creating “noise” that aligns to a normal or gaussian distribution, thus gaussian noise, to add to the data.</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#really-a-small-change-let-s-see-what-happens-to-model-quality">Really a small change, let’s see what happens to model quality</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#now-let-s-take-a-look-at-that-same-scatter-plot-but-with-the-new-data">Now let’s take a look at that same scatter plot but with the new data</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#task-1-slowly-change-the-standard-deviation-increments-of-25-stopping-at-3-5-add-the-noise-array-to-the-dataset-with-each-increase-re-run-the-model-and-see-what-happens-with-the-r2-number-note-the-pace-of-change-of-the-model-write-it-down">Task 1: Slowly change the standard deviation (increments of .25, stopping at 3.5), add the noise array to the dataset with each increase, re-run the model and see what happens with the R2 number, note the pace of change of the model (write it down).</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#task-2-following-the-same-process-above-but-instead-adjust-the-mean-to-three-different-increasing-increments-but-leave-the-standard-dev-at-05-note-how-this-changes-the-model-fit">Task 2: Following the same process above but instead adjust the mean to three different increasing increments but leave the standard dev at .05, note how this changes the model fit.</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#questions-for-submission">Questions for submission:</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#lab-3-knn">Lab 3 - kNN</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#overview">Overview</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#dataset">Dataset</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#part-1-data-preparation-and-model-building">Part 1: Data Preparation and Model Building</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#load-the-libraries">Load the Libraries</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#load-the-dataset">Load the Dataset</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#scale-normalizing-variable-classes-lots-more-but-these-are-the-focus-of-this-lab">Scale/Normalizing/Variable Classes (lots more but these are the focus of this lab)</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#example-of-how-to-collapse-categories">Example of how to collapse categories</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#normalizing-the-numeric-values">Normalizing the numeric values</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#one-hot-encoding-the-categorical-values">One-Hot Encoding the categorical values</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#creating-a-binary-target-variable-so-we-can-run-this-model-as-a-classification-problem">Creating a binary target variable so we can run this model as a classification problem.</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#dropping-variables-and-partitioning-train-test">Dropping Variables and Partitioning (Train/Test)</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#model-building-cell">Model Building Cell</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#evaluation-cell">Evaluation Cell</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#task-1">Task 1</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#part-2-probabilities-of-the-model">Part 2: Probabilities of the Model</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#now-we-are-going-to-add-the-percentage-of-the-probability-for-the-positive-class-good-cereal-to-the-dataframe">Now we are going to add the percentage of the probability for the positive class (good cereal) to the dataframe.</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#graph-the-probabilities">Graph the probabilities</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#task-2-determine-how-the-probabilities-are-calculated">Task 2: Determine how the probabilities are calculated</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#second-model-building-cell">Second Model Building Cell</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#graph-cell">Graph Cell</a></li>
</ul>
</li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Brian Wright and Peter Alonzi
</p>

  </div>
  
  <div class="footer-item">
    
  <p class="copyright">
    
      © Copyright 2022.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=e353d410970836974a52"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>